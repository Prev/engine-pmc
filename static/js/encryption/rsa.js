/*
The MIT License
Copyright (c)2009 Андрій Овчаренко (Andrey Ovcharenko)

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/
// bi2php v0.1.113.alfa from http://code.google.com/p/bi2php/

var biRadixBase=2;var biRadixBits=16;biRadixBits=biRadixBits-biRadixBits%4;var bitsPerDigit=biRadixBits;var biRadix=1<<biRadixBits;var biHalfRadix=biRadix>>>1;var biRadixSquared=biRadix*biRadix;var maxDigitVal=biRadix-1;var maxInteger=4294967295;var biHexPerDigit=biRadixBits/4;var bigZero=biFromNumber(0);var bigOne=biFromNumber(1);var dpl10=9;var lr10=biFromNumber(1000000000);function BigInt(i){this.isNeg=false;if(i==-1)return;if(i){this.digits=new Array(i);while(i)this.digits[--i]=0}else this.digits=[0]}BigInt.prototype.isZero=function(){return this.digits[0]==0&&biNormalize(this).digits.length==1};BigInt.prototype.isOne=function(){return this.digits[0]==1&&!this.isNeg&&biNormalize(this).digits.length==1};BigInt.prototype.isEqual=function(bis){if(this.isNeg!=bis.isNeg)return false;if(this.digits.length!=bis.digits.length)return false;for(var i=this.digits.length-1;i>-1;i--)if(this.digits[i]!=bis.digits[i])return false;return true};BigInt.prototype.blankZero=function(){this.digits.length=1;this.digits[0]=0};BigInt.prototype.blankOne=function(){this.digits.length=1;this.digits[0]=1};BigInt.prototype.blankEmpty=function(){this.digits.length=0};function biCopy(bi){var result=new BigInt(-1);result.digits=bi.digits.slice(0);result.isNeg=bi.isNeg;return result}function biAbs(bi){var result=new BigInt(-1);result.digits=bi.digits.slice(0);result.isNeg=false;return result}function biMinus(bi){var result=new BigInt(-1);result.digits=bi.digits.slice(0);result.isNeg=!bi.isNeg;return result}function biFromNumber(i){if(Math.abs(i)>maxInteger)return(biFromFloat(i));var result=new BigInt();if(result.isNeg=i<0)i=-i;var j=0;while(i>0){result.digits[j++]=i&maxDigitVal;i>>>=biRadixBits}return result}function biFromFloat(i){var result=new BigInt();if(result.isNeg=i<0)i=-i;var j=0;while(i>0){var c=Math.floor(i/biRadix);result.digits[j++]=i-c*biRadix;i=c}return result}function biFromString(s,radix){if(radix==16)return biFromHex(s);var isNeg=s.charAt(0)=='-';var first=(isNeg?1:0)-1;var result=new BigInt();var place=biCopy(bigOne);for(var i=s.length-1;i>first;i--){var c=s.charCodeAt(i);var digit=charToHex(c);var biDigit=biMultiplyDigit(place,digit);result=biAdd(result,biDigit);place=biMultiplyDigit(place,radix)}result.isNeg=isNeg;return biNormalize(result)}function biFromDecimal(s){return biFromString(s,10)}function biFromHex(s){var result=new BigInt();if(s.charAt(0)=='-'){result.isNeg=true;s=substr(s,1)}else{result.isNeg=false}var sl=s.length;for(var i=sl,j=0;i>0;i-=biHexPerDigit,j++)result.digits[j]=hexToDigit(s.substr(Math.max(i-biHexPerDigit,0),Math.min(i,biHexPerDigit)));return biNormalize(result)}function reverseStr(s){var result="";for(var i=s.length-1;i>-1;i--)result+=s.charAt(i);return result}var hexatrigesimalToChar=new Array('0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z');function biToString(x,radix){if(radix==16)return biToHex(x);var b=biFromNumber(radix);var qr=biDivideModulo(biAbs(x),b);var result=hexatrigesimalToChar[qr[1].digits[0]];while(!qr[0].isZero()){qr=biDivideModulo(qr[0],b);result+=hexatrigesimalToChar[qr[1].digits[0]]}return(x.isNeg?"-":"")+reverseStr(result)}function biToDecimal(x){return biToString(x,10)}var hexToChar=new Array('0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f');function digitToHex(n){var mask=0xf;var result="";for(var i=0;i<biHexPerDigit;i++){result+=hexToChar[n&mask];n>>>=4}return reverseStr(result)}function digitToHexTrunk(n){if(n==0)return"0";var mask=0xf;var result="";for(var i=0;i<biHexPerDigit&&n>0;i++){result+=hexToChar[n&mask];n>>>=4}return reverseStr(result)}function biToHex(x){var result=x.isNeg?"-":"";var i=biHighIndex(x);result+=digitToHexTrunk(x.digits[i--]);while(i>-1)result+=digitToHex(x.digits[i--]);return result}function biToNumber(x){var result=0;var faktor=1;var k=biHighIndex(x)+1;for(var i=0;i<k;i++){result+=x.digits[i]*faktor;faktor*=biRadix}return x.isNeg?-result:result}function charToHex(c){var ZERO=48;var NINE=ZERO+9;var littleA=97;var littleZ=littleA+25;var bigA=65;var bigZ=65+25;var result;if(c>=ZERO&&c<=NINE)result=c-ZERO;else if(c>=bigA&&c<=bigZ)result=10+c-bigA;else if(c>=littleA&&c<=littleZ)result=10+c-littleA;else result=0;return result}function hexToDigit(s){var result=0;var sl=Math.min(s.length,biHexPerDigit);for(var i=0;i<sl;i++){result<<=4;result|=charToHex(s.charCodeAt(i))}return result}function biDump(b){return(b.isNeg?"minus ":"plus ")+b.digits.join(" ")}function biNormalize(x){var k=x.digits.length;if(x.digits[k-1]!=0&&!isNaN(x.digits[k-1]))return x;for(var i=k-1;i>0;i--)if(x.digits[i]==0||isNaN(x.digits[i]))x.digits.pop();else return x;if(x.digits.length==1&&x.digits[0]==0)x.isNeg=false;if(isNaN(x.digits[0]))throw new Error("Undefined BigInt: "+biDump(x));return x}function biHighIndex(x){biNormalize(x);return x.digits.length-1}function biNumBits(x){var n=biHighIndex(x);var d=x.digits[n];var m=(n+1)*bitsPerDigit;var result;for(result=m;result>m-bitsPerDigit;result--){if((d&biHalfRadix)!=0)break;d<<=1}return result}function biCompareAbs(x,y){var nx=biHighIndex(x);var ny=biHighIndex(y);if(nx!=ny)return 1-2*((nx<ny)?1:0);for(var i=x.digits.length-1;i>-1;i--)if(x.digits[i]!=y.digits[i])return 1-2*((x.digits[i]<y.digits[i])?1:0);return 0}function biCompare(x,y){if(x.isNeg!=y.isNeg)return 1-2*(x.isNeg?1:0);return x.isNeg?-biCompareAbs(x,y):biCompareAbs(x,y)}function biAddNatural(x,y){var nx=biHighIndex(x)+1;var ny=biHighIndex(y)+1;var i=0;var c=0;if(nx>ny){var result=biAbs(x);var source=y;var k=ny}else{var result=biAbs(y);var source=x;var k=nx}while(i<k){result.digits[i]+=source.digits[i]+c;if(result.digits[i]<biRadix){c=0}else{result.digits[i]&=maxDigitVal;c=1}i++}while(c>0){result.digits[i]=(result.digits[i]||0)+c;if(result.digits[i]<biRadix){c=0}else{result.digits[i]&=maxDigitVal;c=1}i++}return result}function biSubtractNatural(x,y){var nx=biHighIndex(x)+1;var ny=biHighIndex(y)+1;var result=biAbs(x);var resultdigits=result.digits;var xdigits=x.digits;var ydigits=y.digits;var c=0;for(var i=0;i<ny;i++){if(xdigits[i]>=ydigits[i]-c){resultdigits[i]=xdigits[i]-ydigits[i]+c;c=0}else{resultdigits[i]=biRadix+xdigits[i]-ydigits[i]+c;c=-1}}while(c<0&&i<nx){if(xdigits[i]>=-c){resultdigits[i]=xdigits[i]+c;c=0}else{resultdigits[i]=biRadix+xdigits[i]+c;c=-1}i++}return biNormalize(result)}function biAdd(x,y){var result;if(!x.isNeg&&!y.isNeg)return biAddNatural(x,y);if(x.isNeg&&y.isNeg){result=biAddNatural(x,y);result.isNeg=true;return result}var x_y=biCompareAbs(x,y);if(x_y==0)return biFromNumber(0);if(x_y>0){result=biSubtractNatural(x,y);result.isNeg=x.isNeg}if(x_y<0){result=biSubtractNatural(y,x);result.isNeg=y.isNeg}return result}function biSubtract(x,y){var result;if(!x.isNeg&&y.isNeg)return biAddNatural(x,y);if(x.isNeg&&!y.isNeg){result=biAddNatural(x,y);result.isNeg=true;return result}var x_y=biCompareAbs(x,y);if(x_y==0)return biCopy(bigZero);if(x_y>0){result=biSubtractNatural(x,y);result.isNeg=x.isNeg}if(x_y<0){result=biSubtractNatural(y,x);result.isNeg=!x.isNeg}return result}function biMultiply(x,y){var c,u,uv,k;var n=biHighIndex(x)+1;var t=biHighIndex(y)+1;if(n==1&&x.digits[0]==0||t==1&&y.digits[0]==0)return new BigInt();var result=new BigInt(n+t);var resultdigits=result.digits;var xdigits=x.digits;var ydigits=y.digits;for(var i=0;i<t;i++){c=0;k=i;for(var j=0;j<n;j++,k++){uv=resultdigits[k]+xdigits[j]*ydigits[i]+c;resultdigits[k]=uv&maxDigitVal;c=uv>>>biRadixBits}resultdigits[i+n]=c}result.isNeg=x.isNeg!=y.isNeg;return biNormalize(result)}function biMultiplyDigit(x,y){var n=biHighIndex(x)+1;var result=new BigInt(n);var c=0;for(var j=0;j<n;j++){var uv=result.digits[j]+x.digits[j]*y+c;result.digits[j]=uv&maxDigitVal;c=uv>>>biRadixBits}result.digits[n]=c;return result}function arrayCopy(src,srcStart,dest,destStart,count){if(srcStart>=src.length){if(dest.length==0)dest[0]=0;return}for(var i=0;i<destStart;i++)dest[i]=0;var m=Math.min(srcStart+count,src.length);for(var i=srcStart,j=destStart;i<m;i++,j++)dest[j]=src[i]}function biShiftLeft(x,n){var digitCount=Math.floor(n/bitsPerDigit);var result=new BigInt();arrayCopy(x.digits,0,result.digits,digitCount,x.digits.length);var bits=n%bitsPerDigit;var rightBits=bitsPerDigit-bits;result.digits[result.digits.length]=result.digits[result.digits.length]>>>rightBits;for(var i=result.digits.length-1;i>0;i--)result.digits[i]=((result.digits[i]<<bits)&maxDigitVal)|(result.digits[i-1]>>>rightBits);result.digits[0]=(result.digits[0]<<bits)&maxDigitVal;result.isNeg=x.isNeg;return biNormalize(result)}function biShiftRight(x,n){var digitCount=Math.floor(n/bitsPerDigit);var result=new BigInt();arrayCopy(x.digits,digitCount,result.digits,0,x.digits.length-digitCount);var bits=n%bitsPerDigit;var leftBits=bitsPerDigit-bits;for(var i=0;i<result.digits.length-1;i++)result.digits[i]=(result.digits[i]>>>bits)|((result.digits[i+1]<<leftBits)&maxDigitVal);result.digits[result.digits.length-1]>>>=bits;result.isNeg=x.isNeg;return biNormalize(result)}function biMultiplyByRadixPower(x,n){var result=new BigInt();arrayCopy(x.digits,0,result.digits,n,x.digits.length);return result}function biDivideByRadixPower(x,n){var result=new BigInt();arrayCopy(x.digits,n,result.digits,0,x.digits.length-n);return result}function biModuloByRadixPower(x,n){var result=new BigInt();arrayCopy(x.digits,0,result.digits,0,n);return result}function biMultiplyModByRadixPower(x,y,p){var c,u,uv,k;var n=biHighIndex(x)+1;var t=biHighIndex(y)+1;if(n==1&&x.digits[0]==0||t==1&&y.digits[0]==0)return new BigInt();var result=new BigInt(p);var resultdigits=result.digits;var xdigits=x.digits;var ydigits=y.digits;for(var i=0;i<t&&i<p;i++){c=0;k=i;for(j=0;j<n&&k<p;j++,k++){uv=resultdigits[k]+xdigits[j]*ydigits[i]+c;resultdigits[k]=uv&maxDigitVal;c=uv>>>biRadixBits}resultdigits[i+n]=c}result=biModuloByRadixPower(result,p);result.isNeg=x.isNeg!=y.isNeg;return biNormalize(result)}function biDivideModuloNatural(x,y){var j0,j1,jm,qm,flag;var nx=biHighIndex(x);var ny=biHighIndex(y);var q=new BigInt(-1);q.digits=[];var r=new BigInt();for(var i=nx;i>-1;i--){r.digits.unshift(x.digits[i]);flag=biCompareAbs(y,r);if(flag>0){q.digits.unshift(0);continue}if(flag==0){q.digits.unshift(1);r.blankZero();continue}var nr=biHighIndex(r);if(nr==ny)jm=Math.floor((r.digits[nr]*biRadix+(r.digits[nr-1]||0))/(y.digits[ny]*biRadix+(y.digits[ny-1]||0)+1));else jm=Math.floor((r.digits[nr]*biRadixSquared+(r.digits[nr-1]||0)*biRadix+(r.digits[nr-2]||0))/(y.digits[ny]*biRadix+(y.digits[ny-1]||0)+1));jm=Math.max(0,Math.min(jm,maxDigitVal));qm=biMultiplyDigit(y,jm);r=biSubtract(r,qm);if(r.isNeg)while(r.isNeg){r=biAdd(r,y);jm--}else while(biCompare(r,y)>=0){r=biSubtract(r,y);jm++}q.digits.unshift(jm)}return[biNormalize(q),biNormalize(r)]}function biDivideModulo(x,y){var q,r;if(biCompareAbs(x,y)<0){if((x.isNeg&&y.isNeg)||(!x.isNeg&&!y.isNeg)){q=biFromNumber(0);r=biCopy(x)}else{q=biFromNumber(-1);r=biAdd(y,x)}return[q,r]}var origXIsNeg=x.isNeg;var origYIsNeg=y.isNeg;var result=biDivideModuloNatural(biAbs(x),biAbs(y));q=result[0];r=result[1];if(!origXIsNeg&&!origYIsNeg){return[q,r]}else if(origXIsNeg&&origYIsNeg){r.isNeg=true;return[q,r]}else{q.isNeg=true;q=biSubtract(q,bigOne);r.isNeg=origXIsNeg;r=biAdd(r,y)}if(r.digits[0]==0&&biHighIndex(r)==0)r.isNeg=false;return[q,r]}function biDivide(x,y){return biDivideModulo(x,y)[0]}function biModulo(x,y){return biDivideModulo(x,y)[1]}function biMultiplyMod(x,y,m){return biModulo(biMultiply(x,y),m)}function biPow(x,y){var result=biCopy(bigOne);var a=x;while(true){if((y&1)!=0)result=biMultiply(result,a);y>>>=1;if(y==0)break;a=biMultiply(a,a)}return result}function biPowMod(x,y,m){var result=biCopy(bigOne);var a=x;var k=y;while(true){if((k.digits[0]&1)!=0)result=biMultiplyMod(result,a,m);k=biShiftRight(k,1);if(k.digits[0]==0&&biHighIndex(k)==0)break;a=biMultiplyMod(a,a,m)}return result}function biRandom(n){var result=new BigInt();while(n--)result.digits[n]=Math.floor(Math.random()*maxDigitVal);return result}
function biModularInverse(e,m){e=biModulo(e,m);var result=biExtendedEuclid(m,e);if(!result[2].isOne())return null;return biModulo(result[1],m)}function biExtendedEuclid(a,b){if(biCompare(a,b)>=0)return biExtendedEuclidNatural(a,b);var result=biExtendedEuclidNatural(b,a);return[result[1],result[0],result[2]]}function biExtendedEuclidNatural(a,b){var qr,q,r,x1,x2,y1,y2,x,y;if(b.isZero())return[biFromNumber(1),biFromNumber(0),a];x1=biFromNumber(0);x2=biFromNumber(1);y1=biFromNumber(1);y2=biFromNumber(0);while(!b.isZero()){qr=biDivideModulo(a,b);q=qr[0];r=qr[1];x=biSubtract(x2,biMultiply(q,x1));y=biSubtract(y2,biMultiply(q,y1));a=b;b=r;x2=x1;x1=x;y2=y1;y1=y}return[x2,y2,a]}function biMontgomeryPowMod(T,EXP,N){var result=biFromNumber(1);var m=biModulo(biMultiply(T,N.R),N);for(var i=EXP.bin.length-1;i>-1;i--){if(EXP.bin.charAt(i)=="1"){result=biMultiply(result,m);result=biMontgomeryModulo(result,N)}m=biMultiply(m,m);m=biMontgomeryModulo(m,N)}return result}function biMontgomeryModulo(T,N){var m=biModuloByRadixPower(T,N.nN);m=biMultiplyModByRadixPower(m,N.Ninv,N.nN);m=biMultiply(m,N);m=biAdd(T,m);m=biDivideByRadixPower(m,N.nN);while(biCompare(m,N)>=0){m=biSubtract(m,N)}return m}
function RSA(publicKey,privateKey,modulus){if(privateKey===null)privateKey="0";this.e=biFromHex(publicKey);this.d=biFromHex(privateKey);this.m=biFromHex(modulus);this.chunkSize=2*biHighIndex(this.m);this.radix=16;this.m.nN=biHighIndex(this.m)+1;this.m.R=biMultiplyByRadixPower(biFromNumber(1),this.m.nN);this.m.EGCD=biExtendedEuclid(this.m.R,this.m);this.m.Ri=this.m.EGCD[0];this.m.Rinv=biModulo(this.m.EGCD[0],this.m);this.m.Ni=biMinus(this.m.EGCD[1]);this.m.Ninv=biModulo(biMinus(this.m.EGCD[1]),this.m.R);this.e.bin=biToString(this.e,2);this.d.bin=biToString(this.d,2)}RSA.prototype.encrypt=biEncryptedString;RSA.prototype.decrypt=biDecryptedString;function biEncryptedString(s){s=biUTF8Encode(s);s=s.replace(/[\x00]/gm,String.fromCharCode(255));s=s+String.fromCharCode(254);var sl=s.length;s=s+biRandomPadding(this.chunkSize-sl%this.chunkSize);var sl=s.length;var result="";var i,j,k,block;block=new BigInt();for(var i=0;i<sl;i+=this.chunkSize){block.blankZero();j=0;for(k=i;k<i+this.chunkSize&&k<sl;++j){block.digits[j]=s.charCodeAt(k++);block.digits[j]+=(s.charCodeAt(k++)||0)<<8}var crypt=biMontgomeryPowMod(block,this.e,this.m);var text=biToHex(crypt);result+=text+","}return result.substring(0,result.length-1)}function biDecryptedString(s){var blocks=s.split(",");var result="";var i,j,block;for(i=0;i<blocks.length;++i){var bi;bi=biFromHex(blocks[i],10);block=biMontgomeryPowMod(bi,this.d,this.m);for(j=0;j<=biHighIndex(block);++j){result+=String.fromCharCode(block.digits[j]&255,block.digits[j]>>8)}}result=result.replace(/\xff/gm,String.fromCharCode(0));result=result.substr(0,result.lastIndexOf(String.fromCharCode(254)));return biUTF8Decode(result)}function biUTF8Encode(string){var utftext="";var sl=string.length;for(var n=0;n<sl;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c)}else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128)}else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128)}}return utftext}function biUTF8Decode(s){var utftext="";var sl=s.length;var charCode;for(var n=0;n<sl;n++){var c=s.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);charCode=0}else if((c>191)&&(c<224)){charCode=((c&0x1f)<<6);c=s.charCodeAt(++n);charCode+=(c&0x3f);utftext+=String.fromCharCode(charCode)}else{charCode=((c&0xf)<<12);c=s.charCodeAt(++n);charCode+=((c&0x3f)<<6);c=s.charCodeAt(++n);charCode+=(c&0x3f);utftext+=String.fromCharCode(charCode)}}return utftext}function biRandomPadding(n){var result="";for(var i=0;i<n;i++)result=result+String.fromCharCode(Math.floor(Math.random()*126)+1);return result}